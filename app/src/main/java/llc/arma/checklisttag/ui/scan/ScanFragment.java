package llc.arma.checklisttag.ui.scan;import android.content.Context;import android.os.Bundle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import androidx.annotation.NonNull;import androidx.annotation.Nullable;import androidx.databinding.DataBindingUtil;import androidx.fragment.app.DialogFragment;import androidx.fragment.app.FragmentResultListener;import androidx.lifecycle.ViewModelProvider;import com.google.android.material.snackbar.Snackbar;import llc.arma.checklisttag.R;import llc.arma.checklisttag.databinding.ScanFragmentBinding;public class ScanFragment extends DialogFragment implements FragmentResultListener {    private ScanFragmentBinding binding;    private ScanViewModel viewModel;    @Nullable    @Override    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,                             @Nullable Bundle savedInstanceState) {        binding = DataBindingUtil.inflate(inflater, R.layout.scan_fragment, container,                false);        binding.setLifecycleOwner(getViewLifecycleOwner());        binding.setModel(viewModel);        return binding.getRoot();    }    @Override    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {        super.onViewCreated(view, savedInstanceState);        viewModel.start(requireArguments().getString("sid"));        viewModel.getCloseEvent().observe(getViewLifecycleOwner(), event -> {            if(event.isHandled()){                requireActivity().onBackPressed();            }        });        viewModel.getSetResultEvent().observe(getViewLifecycleOwner(), event -> {            if(event.isHandled()){                requireActivity().getSupportFragmentManager()                        .setFragmentResult("nfcScan", event.getContent());                requireActivity().onBackPressed();            }        });        viewModel.getShowNfcExistWarningEvent().observe(getViewLifecycleOwner(), event ->                Snackbar.make(binding.getRoot(), "Метка уже есть", Snackbar.LENGTH_LONG).show());        requireActivity().getSupportFragmentManager()                .setFragmentResultListener("scan", requireActivity(), this);    }    @Override    public void onFragmentResult(@NonNull String requestKey, @NonNull Bundle result) {        viewModel.onScanned(result.getString("nfcId"));    }    @Override    public void onAttach(@NonNull Context context) {        super.onAttach(context);        viewModel = new ViewModelProvider(this).get(ScanViewModel.class);    }}